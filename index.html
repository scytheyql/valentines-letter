<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentines Letter ngaun</title>
<style>
body {
    margin: 0;
    padding: 0;
    background-color: #add8e6;
    font-family: 'Courier New', monospace;
    color: #5f9ea0;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    position: relative;
}

.image-bg {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
}

.intro-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(14, 59, 109, 0.226);
    backdrop-filter: blur(20px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10;
    cursor: pointer;
}

.intro-text {
    font-size: 36px;
    color: #5f9ea0;
    text-shadow: 0 0 5px rgba(173,216,230,0.5),0 0 10px rgba(0,191,255,0.3);
    -webkit-text-stroke:0.5px rgba(255,255,255,0.2);
    text-align:center;
}

.dark-overlay {
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background-color:rgba(5,2,150,0.171);
    z-index:1;
}

.text-box {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgba(1,21,109,0.199);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 20px;
    max-width: 600px;
    text-align: center;
    z-index: 2;
    box-shadow: 0 0 20px rgba(173,216,230,0.2);
    display:none;
    transition: transform 0.1s ease;
}

.text-box.shake {
    animation: shake 0.5s ease;
}

@keyframes shake {
    0%,100%{transform:translateX(0);}
    10%,30%,50%,70%,90%{transform:translateX(-5px);}
    20%,40%,60%,80%{transform:translateX(5px);}
}

.typewriter {
    font-size:24px;
    line-height:1.5;
    color:#5f9ea0;
    text-shadow:0 0 5px rgba(173,216,230,0.5),0 0 10px rgba(0,191,255,0.3);
    -webkit-text-stroke:0.5px rgba(255,255,255,0.2);
    position:relative;
}

.typewriter::after {
    content:'|';
    animation: blink 1s infinite;
    color:#5f9ea0;
    text-shadow:0 0 5px rgba(173,216,230,0.5);
    -webkit-text-stroke:0.5px rgba(255,255,255,0.2);
}

@keyframes blink {
    0%,50%{opacity:1;}
    51%,100%{opacity:0;}
}

.selection {
    background-color:#b0e0e6;
    color:black;
    padding:0 2px;
    border-radius:2px;
}

.heart {
    position: absolute;
    width: 70px;
    height: 63px;
    --heart-color: #1e90ff;
    --darker-color: #00008b;
    background: linear-gradient(45deg, var(--heart-color), var(--darker-color));
    border-radius: 10px;
    z-index: 2;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2), 0 0 10px var(--heart-color);
    opacity: 0.8;
}

.heart::before,
.heart::after {
    content: "";
    position: absolute;
    width: 70px;
    height: 63px;
    background: linear-gradient(45deg, var(--heart-color), var(--darker-color));
    border-radius: 50%;
}

.heart::before { top:-31.5px; left:0; }
.heart::after { left:35px; top:0; }

.heart.outlined {
    border: 2px solid var(--heart-color);
}

.sparkle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: white;
    border-radius: 50%;
    z-index: 1;
    animation: twinkle 1s infinite;
}

@keyframes twinkle {
    0%, 100% { opacity: 0; transform: scale(0); }
    50% { opacity: 1; transform: scale(1); }
}

.spark {
    position: absolute;
    width: 2px;
    height: 2px;
    background: #1e90ff;
    border-radius: 50%;
    z-index: 1;
    animation: sparkFade 0.5s ease-out forwards;
}

@keyframes sparkFade {
    0% { opacity: 1; transform: scale(1); }
    100% { opacity: 0; transform: scale(0); }
}

.trail {
    position: absolute;
    width: 70px;
    height: 63px;
    background: linear-gradient(45deg, var(--heart-color), var(--darker-color));
    border-radius: 10px;
    z-index: 1;
    opacity: 0.3;
    filter: blur(2px);
}
</style>
</head>
<body>

<video class="image-bg" autoplay muted playsinline loop>
    <source src="bgvideo.mp4" type="video/mp4">
</video>

<div class="dark-overlay"></div>

<audio id="bg-music" loop>
    <source src="bgmusic.mp3" type="audio/mpeg">
</audio>

<div class="intro-overlay" id="intro-overlay">
    <div class="intro-text">Click to Open</div>
</div>

<div class="text-box" id="text-box">
    <div id="typewriter-text" class="typewriter"></div>
</div>

<script>
const text = `hello!! good afternoon, morning, or evening, whenever you opened this letter.. just for you! I might've borrowed some code from my last one, but it's okay.. I still put in a lot of effort in this, maybe stayed up a night to fix everything, I tried my best! because I love you, even if we had that miscommunication that one time, even if I thought you didn't like me, deep down, I liked you still, even if I told others something else. It always rested at the back of my mind, thinking about a lot of things.. but even if my mind is always stuffed, theres always room for you, I always think abobut you, I honestly can't see myself with another girl in the future besides for you, anyhow.. happy valentines! I hope you enjoy the gifts you got given, especially the chocolates, I'm making this very early. lets see if I give you anything besides for this.. I LOOVEEE YOUU! <3`;

const typewriterElement = document.getElementById('typewriter-text');
const introOverlay = document.getElementById('intro-overlay');
const textBox = document.getElementById('text-box');
const bgMusic = document.getElementById('bg-music');
let index = 0;
let isCorrecting = false;

bgMusic.volume = 0.5;

function typeWriter() {
    if(index < text.length){
        const char = text.charAt(index);
        if(!isCorrecting && Math.random()<0.02 && char.match(/[a-zA-Z]/)){
            isCorrecting = true;
            const wrongChar = getRandomTypo(char);
            typewriterElement.innerHTML += `<span class="selection">${wrongChar}</span>`;
            setTimeout(()=>{
                typewriterElement.innerHTML = typewriterElement.innerHTML.replace(
                    `<span class="selection">${wrongChar}</span>`,''
                );
                setTimeout(()=>{
                    typewriterElement.innerHTML += char;
                    index++;
                    isCorrecting=false;
                    setTimeout(typeWriter,50);
                },200);
            },300);
        }else{
            typewriterElement.innerHTML += char;
            index++;
            setTimeout(typeWriter,50);
        }
    }
}

function getRandomTypo(char){
    const typos = { 'a':'s','s':'a','e':'r','r':'e','t':'y','y':'t','i':'o','o':'i','n':'m','m':'n','h':'j','j':'h'};
    return typos[char.toLowerCase()] || char;
}

const heartColors = ['#1e90ff', '#4169e1', '#0000cd', '#00008b', '#191970'];

function getDarkerColor(color) {
    const r = parseInt(color.slice(1,3), 16) * 0.7;
    const g = parseInt(color.slice(3,5), 16) * 0.7;
    const b = parseInt(color.slice(5,7), 16) * 0.7;
    return `rgb(${Math.floor(r)}, ${Math.floor(g)}, ${Math.floor(b)})`;
}

function createHearts() {
    const heartCount = 50;
    const hearts = [];
    const stacks = [];
    const sparkles = [];

    for (let i = 0; i < heartCount; i++) {
        const heart = document.createElement('div');
        heart.className = 'heart';

        const color = heartColors[Math.floor(Math.random() * heartColors.length)];
        const darker = getDarkerColor(color);
        heart.style.setProperty('--heart-color', color);
        heart.style.setProperty('--darker-color', darker);

        heart.style.opacity = 0.7 + Math.random() * 0.3;

        if (Math.random() > 0.7) heart.classList.add('outlined');

        let left;
        if(i%2===0) left = Math.random()*15;
        else if(i%3===0) left = 85+Math.random()*15;
        else left = 20+Math.random()*60; 
        heart.style.left = left + '%';

        const scale = 0.6 + Math.random()*0.4;
        heart.style.transform = `rotate(-45deg) scale(${scale})`;

        let y = -50 - Math.random()*200;

        document.body.appendChild(heart);

        hearts.push({
            el: heart,
            x: heart.offsetLeft,
            y: y,
            vy: 1 + Math.random()*1.5,
            drift: (Math.random()*0.6 - 0.3),
            scale: scale,
            landed: false,
            leftPercent: left,
            bounceCount: 0,
            rolling: false,
            rollDirection: Math.random() > 0.5 ? 1 : -1,
            rollSpeed: 0.5 + Math.random() * 0.5,
            rotation: -45,
            rollTime: 0,
            sparkleTimer: 0,
            trail: null
        });
    }

    function createSparkles(heart) {
        for (let j = 0; j < 4; j++) {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.style.left = (heart.x + Math.random() * 70 - 35) + 'px';
            sparkle.style.top = (heart.y + Math.random() * 63 - 31.5) + 'px';
            document.body.appendChild(sparkle);
            sparkles.push({ el: sparkle, life: 60 });
        }
    }

    function createSparks(x, y) {
        for (let j = 0; j < 5; j++) {
            const spark = document.createElement('div');
            spark.className = 'spark';
            spark.style.left = (x + Math.random() * 20 - 10) + 'px';
            spark.style.top = (y + Math.random() * 10) + 'px';
            document.body.appendChild(spark);
            setTimeout(() => spark.remove(), 500);
        }
    }

    function createTrail(heart) {
        if (!heart.trail) {
            const trail = document.createElement('div');
            trail.className = 'trail';
            trail.style.setProperty('--heart-color', heart.el.style.getPropertyValue('--heart-color'));
            trail.style.setProperty('--darker-color', heart.el.style.getPropertyValue('--darker-color'));
            document.body.appendChild(trail);
            heart.trail = trail;
        }
        heart.trail.style.left = heart.x + 'px';
        heart.trail.style.top = heart.y + 'px';
        heart.trail.style.transform = `rotate(${heart.rotation}deg) scale(${heart.scale})`;
    }

    function animate() {
        sparkles.forEach((s, idx) => {
            s.life--;
            if (s.life <= 0) {
                s.el.remove();
                sparkles.splice(idx, 1);
            }
        });

        hearts.forEach(h => {
            const pulse = Math.sin(Date.now() * 0.005) * 0.01;
            h.scale += pulse;

            h.sparkleTimer++;
            if (h.sparkleTimer > 30) {
                createSparkles(h);
                h.sparkleTimer = 0;
            }

            if(!h.landed){
                h.y += h.vy;
                h.vy += 0.05;
                h.x += h.drift;

                let ground = window.innerHeight - 63*h.scale;
                stacks.forEach(s => {
                    if(Math.abs(s.left - h.leftPercent)<5){
                        if(ground > s.y) ground = s.y;
                    }
                });

                if(h.y >= ground){
                    h.y = ground;
                    createSparks(h.x, h.y);
                    if(h.vy > 0){
                        h.vy = -h.vy*0.7;
                        h.bounceCount++;
                        h.rotation += 10 * (Math.random() > 0.5 ? 1 : -1);
                        if(h.bounceCount > 3) {
                            h.vy = 0;
                            h.landed = true;
                            stacks.push({left:h.leftPercent, y:h.y - 2});
                            h.rolling = true;
                        }
                    } else {
                        h.vy = 0;
                        h.landed = true;
                        stacks.push({left:h.leftPercent, y:h.y - 2});
                        h.rolling = true;
                    }
                }

                h.el.style.top = h.y + 'px';
                h.el.style.left = h.x + 'px';
                h.el.style.transform = `rotate(${h.rotation}deg) scale(${h.scale})`;
            } else if(h.rolling) {
                h.rollTime++;
                const prevX = h.x;
                h.x += h.rollDirection * h.rollSpeed;
                if(h.x < 0 || h.x > window.innerWidth - 70) h.rollDirection *= -1;
                h.rotation += (h.x - prevX) * 2;

                const textBoxRect = textBox.getBoundingClientRect();
                const heartRect = { left: h.x, top: h.y, right: h.x + 70, bottom: h.y + 63 };
                if (heartRect.right > textBoxRect.left && heartRect.left < textBoxRect.right &&
                    heartRect.bottom > textBoxRect.top && heartRect.top < textBoxRect.bottom) {
                    if (h.x < textBoxRect.left) h.x -= 5;
                    else h.x += 5;
                }

                if (h.rollTime > 300) {
                    h.vy = -0.5;
                    h.el.style.opacity = Math.max(0, parseFloat(h.el.style.opacity) - 0.01);
                    if (h.el.style.opacity <= 0) {
                        h.el.remove();
                        if (h.trail) h.trail.remove();
                        hearts.splice(hearts.indexOf(h), 1);
                    }
                }

                h.el.style.left = h.x + 'px';
                h.el.style.top = h.y + 'px';
                h.el.style.transform = `rotate(${h.rotation}deg) scale(${h.scale})`;
            }

            createTrail(h);
        });

        requestAnimationFrame(animate);
    }

    animate();
}

document.addEventListener('visibilitychange',()=>{if(document.hidden) bgMusic.pause();});
window.addEventListener('beforeunload',()=>{bgMusic.pause();});

introOverlay.addEventListener('click',()=>{
    introOverlay.style.display='none';
    textBox.style.display='block';
    textBox.classList.add('shake');
    setTimeout(()=>textBox.classList.remove('shake'),500);
    bgMusic.play();
    typeWriter();
    createHearts();
});
</script>
</body>
</html>
